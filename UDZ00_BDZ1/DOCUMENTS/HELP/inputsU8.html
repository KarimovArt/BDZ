<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
   <head>
      <title>ВХОДЫ</title>
      <meta charset="utf-8"/> 
   </head>

   <body>
<h2 id="содержание"> Содержание </h2> 
<ul>
   <li> <a href="#входы">Структура входов</a></li>
   <li> <a href="#выходы">Структура выходов</a></li>
   <li> <a href="#индикация">Индикация</a></li>
   <li> <a href="#таймеры">Таймеры</a></li>
   <li> <a href="#работа">Работа</a></li>
   <li> <a href="#программирование">Программирование</a></li>

</ul>
 
 
 <h2 id="входы"> Структура входов </h2>
   <ol>
      <li>Флаги: активен,неисправен,срабатывал,режим(источник аварии/подтверждения).</li>
      <li>Указатель на объединение в EEPROM, в котором содержатся входы подтверждения (младший байт,младшая тетрада) и режим (МТЗ,УРОВ) подтверждения (старший байт,младшая тетрада).</li>
      <li>Указатель на байт в EEPROM,в котором содержатся выходные реле.</li>
   </ol>
<a href="#содержание">В начало</a>
 <h2 id="выходы">Структура выходов </h2> 
   <ol>
      <li>Флаги: неисправность,было срабатывание,было отпускание.</li>
      <li>Указатель на объединение в EEPROM, в котором содержатся задержки включения и задержки выключения.</li>
      <li>Порт и пин, к которому подключено реле.</li>
   </ol>
<a href="#содержание">В начало</a>
 <h2 id="индикация">Индикация </h2> 
   <ol>
      <li>
         Входы:
         <ul>
            <li>Горит-вход является источником аварии.</li>
            <li>Редко мигает-вход является источником подтверждения.</li>
            <li>Часто мигает-вход неисправен.</li>
         </ul>
      </li>
      <li>
         Выходы:
         <ul>
            <li>Горит-выход активизирован.</li>
            <li>Редко мигает-выход сработал импульсно.</li>
            <li>Часто мигает-выход неисправен.</li>
         </ul>
      </li>
    </ol>
<p>
Алгоритм:</br>
<p>У каждого СД есть статус: ON(включен), OFF(выключен), SB(короткое мигание), LB(длинное мигание)</p>
<ul>
<li>Зажигаем входы  c ON, SB, LB;</li>
<li>Пауза со считыванием состояний входов. Если есть сработавщий-прерываем индикацию</li>
<li>Гасим входы и выходы с SB;</li>
<li>Пауза со считыванием состояний входов. Если есть сработавщий-прерываем индикацию</li>
<li>Гасим входы и выходы с LB, зажигаем SB;</li>
<li>Пауза со считыванием состояний входов. Если есть сработавщий-прерываем индикацию</li>
<li>гасим SB;</li>
<li>Пауза со считыванием состояний входов. Если есть сработавщий-прерываем индикацию</li>
</ul>
</p>
<a href="#содержание">В начало</a>
 <h2 id="таймеры">Таймеры </h2>
<p>
Таймеры создаются для обработки входов и для последующего включения выходов. При создании таймер получает:</br>
<ul>
<li>время работы</li>
<li>№ входа, инициировавшего создание</li>
<li>№ входа для подтверждения</li>
<li>режим подтверждения (тип таймера)</li>
<li>№ выхода</li>
</ul>
Существует 4 типа таймеров:
<ul>
<li>МТЗ -таймер ожидания МТЗ. В процессе работы опрашивается вход подтверждения; в случае его активизации создается таймер ВКЛ,в статусе инициализирующего и подтверждающего входа (<a href="#входы">см.Структура входов</a>) фиксируется авария. Таймер МТЗ уничтожается. </li>
<li>УРОВ -таймер ожидания УРОВ. В процессе работы опрашивается вход подтверждения; в случае его деактивации
таймер УРОВ уничтожается, авария не фиксируется. В случае если деактивации входа по окончании времени работы тайиера не произошло создается таймер ВКЛ, в статусе инициализирующего и подтверждающего входа (<a href="#входы">см.Структура входов</a>) фиксируется авария. Таймер УРОВ уничтожается.</li>
<li>ВКЛ -таймер задержки включения выхода. По истечению времени безусловно включает выходное реле и, если задержка отключения выхода не равна нулю, создает таймер ВЫКЛ.Факт включения фиксируется в статусе выхода (<a href="#выходы">см.Структура выходов</a>), таймер ВКЛ уничтожается. </li>
<li>ВЫКЛ -таймер задержки выключения выхода. По истечению времени безусловно выключает выходное реле. Факт выключения фиксируется в статусе выхода (<a href="#выходы">см.Структура выходов</a>), таймер ВЫКЛ уничтожается. </li>
</ul>
</p>
<a href="#содержание">В начало</a>
<h2 id="работа">Работа </h2>
<p>
Основной цикл:
<ul>
<li>индикация с одновременным считыванием цифровых входов</li>
<li>обработка сработавших цифровых входов</li>
<li>отсылка необходимой информации</li>
<li>прием входящих сообщений</li>
<li>тестирование</li>
</ul>
</p>
<p>
Прерывание только от оптических входов (срабатывает по спаду):
<ul>
<li>считывание входов</li>
<li>блокировка сработавших оптических (переключаем в выход с низким уровнем).</li>
<li>запускаем обработчики сработавших входов.</li>
</ul>
</p>
<a href="#содержание">В начало</a>
<h2 id="программирование">Программирование </h2>
<p>
Структура команды:
<ul>
<li>
1й символ - группа команд:
<ul>
<li>0- просмотр активной ошибки</li>
<li>1- просмотр/изменение параметров входов</li>
<li>2- просмотр/изменение параметров выходов</li>
<li>3- просмотр/изменение времен МТЗ/УРОВ</li>
</ul>
</li>
<li>
2й символ - номер входа/выхода. Для просмотра/изменения времен МТЗ/УРОВ или для просмотра ошибки -0

</li> 
<li>
3й символ - номер параметра
<br>для входов (нумерация: 0...3-оптические, 4...7-цифровые):</br>
<ul>
<li>1- входы подтверждения (0-выкл, 1-вкл)</li>
<li>2- режимы подтверждения (0-МТЗ 1-УРОВ)</li>
<li>3- подключенные выходы (0-выкл, 1-вкл)</li>
</ul>
для выходов (нумерация: 0...3):
<ul>
<li>1- задержка включения</li>
<li>2- задержка выключения</li>
</ul>
для времен:
<ul>
<li>1- время ожидания МТЗ</li>
<li>2- время ожидания УРОВ</li>
</ul>
</li>
<li>4й символ - знак "=". </li>
<li>значение параметра</li>
</ul>
Значения параметров:
<ul>
<li>для входов нумерация входов подтверждения, режимов подтверждения и подключенных выходов =3210 </li>
<li>для выходов и времен МТЗ/УРОВ максимальное значение 500мс </li>
</ul>
<br>Для просмотра(без изменений) параметров достаточно первых 3х пунктов.<br>
<br>
Примеры: 
<ul>
<li>103=0010 -для входа №0: подключить выход №1, отключить выходы №3,№2,№0</li>
<li>121=0110 -для входа №2: подключить входы подтверждения №2,№1, отключить выходы №3,№0</li>
<li>152=0010 -для входа №5: для входов подтверждения №3,№2,№0 включить режим "МТЗ"; для входа подтверждения №1 включить режим "УРОВ"  
<li>232=120 -для выхода №3: установить задержку выключения 120мс</li>
<li>302=235 -установить время ожидания УРОВ 235мс</li>
</li>
</ul>
</br>
</p>

<a href="#содержание">В начало</a>


<p> </p>
<p> </p>
<p> </p>

Вход:	 
<select>
    <option value="first option">ОВХ1</option>
    <option value="second option">ОВХ2</option>
    <option value="third option">ОВХ3</option>
    <option value="four option">ОВХ4</option>
</select>

</br>
Входы подтверждения:	
<input type="checkbox" />ЦВХ1
<select>
    <option value="second option">МТЗ</option>
    <option value="fird option">УРОВ</option>
 </select>
<input type="checkbox" />ЦВХ2
<select>
    <option value="second option">МТЗ</option>
    <option value="fird option">УРОВ</option>
 </select>
<input type="checkbox" />ЦВХ3
<select>
    <option value="second option">МТЗ</option>
    <option value="fird option">УРОВ</option>
 </select>
<input type="checkbox" />ЦВХ4
<select>
    <option value="second option">МТЗ</option>
    <option value="fird option">УРОВ</option>
 </select>




<!--
<p><input type="radio" name="areyou" value="male" /> Мужчина</p>
    <p><input type="radio" name="areyou" value="female" /> Женщина</p>
    <p><input type="radio" name="areyou" value="hermaphrodite" /> Ни то ни другое</p>
-->

	
      
   </body>
</html>
